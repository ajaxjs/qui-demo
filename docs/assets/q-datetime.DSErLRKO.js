import{_ as e,n as t,aa as a,al as l,p as n,a5 as i,o,g as s,w as r,c as u,F as c,e as d,C as p,D as f,f as m,t as h,h as g,d as y,X as v,m as $,am as b,an as V,ao as D,ap as S,r as M,k,a as x}from"./index-TqW3uz4B.js";import{_ as C}from"./q-btn-group.B24baQ6R.js";import{_ as w}from"./q-dialog.BEWGc6EX.js";import{c as Y}from"./date-nongli.BjaBr7_O.js";const _={modelValue:Array,options:{type:Array,require:!0},perfix:[String,Array],suffix:[String,Array],align:String,itemLabel:{type:String,default:"label"},itemValue:{type:String,default:"value"},itemHeight:{type:Number,default:40},rowNumber:{type:Number,default:5}};const H=e({props:_,emits:["update:modelValue","change","pickstart","pickend","ready"],setup(e,{emit:o}){const s=e.options?new Array(e.options.length).fill(0):[],r=t(s),u=t(null);function c(t,a){return a={label:e.itemLabel,value:e.itemValue}[a],"object"==typeof t?t[a]:t}function d(t){return e.options.map(((e,a)=>{for(var l=0;l<e.length;l++)if(c(e[l],"value")==t[a])return l;return 0}))}e.modelValue&&(r.value=d(e.modelValue)),a((()=>e.modelValue),(t=>{const a=d(e.modelValue);l(r.value,a)||(r.value=a)}));const p=`height: ${e.itemHeight}px; line-height: ${e.itemHeight}px;`+(e.align?`text-align: ${e.align}`:""),f=n((()=>"height:"+e.itemHeight*e.rowNumber));function m(t){const a=(t=t||r.value).map(((t,a)=>{const l=e.options[a];return t>=l.length-1?l[l.length-1]:l[t]})),l=a.map((e=>c(e,"value")));return{index:t,rawValue:a,value:l}}return i((()=>{o("ready",m())})),{indexValue:r,innerValue:u,styles:f,indicatorStyle:p,getValue:m,getItem:c,getFix:function(e,t){return Array.isArray(e)?e[t]||"":e},onChange:function(e){r.value=e.detail.value;const t=m(r.value);u.value=t.value,e.detail=t,o("update:modelValue",u.value),o("change",e)},onPickstart:function(e){o("pickstart",e)},onPickend:function(e){o("pickend",e)}}}},[["render",function(e,t,a,l,n,i){const D=v,S=$,M=b,k=V;return o(),s(k,{class:"q-picker",value:l.indexValue,style:f(l.styles),"indicator-style":l.indicatorStyle,onChange:l.onChange,onPickstart:l.onPickstart,onPickend:l.onPickend},{default:r((()=>[(o(!0),u(c,null,d(e.options,((t,a)=>(o(),s(M,{key:a},{default:r((()=>[(o(!0),u(c,null,d(t,((t,n)=>(o(),s(S,{class:p(["item",l.indexValue[a]==n?"active":""]),style:f(l.indicatorStyle),key:n},{default:r((()=>[e.perfix?(o(),s(D,{key:0,class:"perfix"},{default:r((()=>[m(h(l.getFix(e.perfix,a)),1)])),_:2},1024)):g("",!0),y(D,{class:"label"},{default:r((()=>[m(h(l.getItem(t,"label")),1)])),_:2},1024),e.suffix?(o(),s(D,{key:1,class:"suffix"},{default:r((()=>[m(h(l.getFix(e.suffix,a)),1)])),_:2},1024)):g("",!0)])),_:2},1032,["class","style"])))),128))])),_:2},1024)))),128))])),_:1},8,["value","style","indicator-style","onChange","onPickstart","onPickend"])}],["__scopeId","data-v-8579e41d"]]),q=(e,t,a)=>{const l=String(e);return!l||l.length>=t?e:`${Array(t+1-l.length).join(a)}${e}`},A=function(e,t){if(e){if(e instanceof j)return e.clone()}else e=new Date;return new j(e,t)};class j{constructor(e,t){this.$format=t||"YYYY-MM-DDTHH:mm:ssZ",this.parse(e),this.init()}init(){const{$d:e}=this;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()}parse(e){const{lifa:t,date:a,leap:l}=function(e){const t=typeof e;let a="公",l=e,n=!1;if(e&&"string"==t){const t=e.match(/^([公农历]+\s+)?(.+?)(\(.+\))?$/);t&&(a=t[1]?t[1].substring(0,1):"公",l=t[2].trim().replace("-","/"),n=!!t[3])}else"object"==t&&e.date&&(["公","农"].includes(e.lifa)&&(a=e.lifa),"boolean"==typeof e.leap&&(n=e.leap),l=e.date);if(Array.isArray(l)){const e=D(l);e[1]<0&&(n=!0,e[1]=Math.abs(e[1])),e[1]-=1,l=new Date(...e)}return{lifa:a,date:new Date(Date.parse(l)),leap:n}}(e);this.$d=a,this.$lifa=t,this.$leap=l}clone(){return D(this)}format(e){const t=e||this.$format,a=(e=>{const t=-e.utcOffset(),a=Math.abs(t),l=Math.floor(a/60),n=a%60;return`${t<=0?"+":"-"}${q(l,2,"0")}:${q(n,2,"0")}`})(this),{$H:l,$m:n,$M:i}=this,o=e=>q(l%12||12,e,"0"),s=(e,t,a)=>{const l=e<12?"AM":"PM";return a?l.toLowerCase():l},r={YY:String(this.$y).slice(-2),YYYY:this.$y,M:i+1,MM:q(i+1,2,"0"),D:this.$D,DD:q(this.$D,2,"0"),d:String(this.$W),H:String(l),HH:q(l,2,"0"),h:o(1),hh:o(2),a:s(l,0,!0),A:s(l,0,!1),m:String(n),mm:q(n,2,"0"),s:String(this.$s),ss:q(this.$s,2,"0"),SSS:q(this.$ms,3,"0"),Z:a};return t.replace(/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,((e,t)=>t||r[e]||a.replace(":","")))}utcOffset(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)}monthDays(){let e=Y.solarDays(this.$y,this.$M+1);return"农"==this.$lifa&&(e=this.$leap?Y.leapDays(this.$y):Y.monthDays(this.$y,this.$M+1)),e}toString(){return[this.$lifa+"历",this.format(),this.$leap?"(闰"+(this.$M+1)+"月)":""].filter((e=>e)).join(" ")}}const L={..._,show:Boolean,position:String,title:String},P=({emit:e})=>{const a=t(null);function l(t){e("update:show",!1),e("close",t)}return{innerValue:a,open:function(t){e("update:show",!0),e("open",t)},close:l,confirm:function(t){console.log(a),e("update:modelValue",a.value),e("confirm",a),l(t)},onChange:function(t){a.value=t.detail.value,e("change",t)}}},N=e=>e>=1900&&e<=2100,T=e=>["公","农"].includes(e),F={...L,modelValue:String,lifa:{type:String,default:"公",validate:T},hideLifa:Boolean,defaults:String,dateType:{type:String,default:"datetime",validate:e=>["datetime","date"].includes(e)},format:String,min:{type:Number,default:()=>1930,validate:N},max:{type:Number,default:()=>2100,validate:N}},R=function(e,t){const a=[];for(let l=e;l<=t;l++)a.push(l);return a},I=({props:e,emit:a})=>{const l=A(e.min),i=A(e.max),o=A((({lifa:e,modelValue:t,hideLifa:a,defaults:l})=>{let n;return n=t?T(t.substr(0,1))?t:e+"历 "+t:l||new Date,n})(e)),s=o.format("YYYY-M-D"+("datetime"==e.dateType?"-H-m":"")).split("-").map((e=>Number(e))),r=t(o.$lifa);o.$leap&&(s[1]=-s[1]);const u=t(s),c=t(null),d=t(null),p=t(e.format||"YYYY-MM-DD"+("datetime"==e.dateType?" HH:mm":"")),f=n((()=>{let t,[a,n]=u.value;"公"==r.value?(n=Math.abs(n),t=Y.solarDays(a,n)):(n=0==Y.leapMonth(a)?Math.abs(n):n,t=n<0?Y.leapDays(a):Y.monthDays(a,n));let o=[];if(o[0]=R(l.$y,i.$y).map((e=>({label:e+"年",value:e}))),"公"==r.value)o[1]=R(1,12).map((e=>({label:S(e,2)+"月",value:e}))),o[2]=R(1,t).map((e=>({label:S(e,2)+"日",value:e})));else{o[1]=R(1,12).map((e=>({label:Y.toChinaMonth(e),value:e})));const e=Y.leapMonth(a);e&&o[1].splice(e,0,{label:"闰"+Y.toChinaMonth(e),value:-e,leap:!0}),o[2]=R(1,t).map((e=>({label:Y.toChinaDay(e),value:e})))}return"datetime"==e.dateType&&(o.push(R(0,23).map((e=>({label:S(e,2)+"时",value:e})))),o.push(R(0,59).map((e=>({label:S(e,2)+"分",value:e}))))),o}));function m(e){if(e.index[2]>f.value[2].length-1){const t=f.value[2].length-1;e.index[2]=t,e.rawValue[2]=f.value[2][t],e.value[2]=f.value[2][t].value}c.value=e,u.value=e.value;const t=e.value,l=t[1]<0,n=A({lifa:r.value,date:t,leap:l},p.value);d.value={qobj:n,lifa:r.value,date:n.format(),leap:l,text:n.toString()},a("change",d)}const{open:h,close:g}=P({props:e,emit:a});return{colName:["年","月","日","时","分","秒"],options:f,lifa:r,innerValue:u,dateVal:d,open:h,close:g,confirm:function(){a("update:modelValue",d.value.text),a("confirm",d),g()},onDateReady:function(e){m(e)},onLifaChange:function(e){r.value=e,m(c.value)},onDateChange:function(e){m(e.detail)}}};const O=e({props:F,emits:["update:modelValue","update:show","confirm","change","open","close"],setup:(e,{emit:t})=>I({props:e,emit:t})},[["render",function(e,t,a,l,n,i){const u=M(x("q-btn"),k),c=M(x("q-btn-group"),C),d=$,p=M(x("q-pickerview"),H),f=M(x("q-dialog"),w);return o(),s(f,{ref:"rootRef",modelValue:e.show,position:e.position,persistent:""},{default:r((()=>[y(d,{class:"q-datetime bg-white"},{default:r((()=>[y(d,{class:"row q-pa-sm"},{default:r((()=>[y(u,{outline:"",color:"blue-grey",label:"取消",onClick:e.close},null,8,["onClick"]),y(d,{class:"row col items-center justify-center"},{default:r((()=>[e.hideLifa?g("",!0):(o(),s(c,{key:0,flat:"",class:"q-mx-md"},{default:r((()=>[y(u,{outline:"公"!==e.lifa,color:"primary",label:"公历",onClick:t[0]||(t[0]=t=>e.onLifaChange("公"))},null,8,["outline"]),y(u,{outline:"农"!==e.lifa,color:"primary",label:"农历",onClick:t[1]||(t[1]=t=>e.onLifaChange("农"))},null,8,["outline"])])),_:1}))])),_:1}),y(u,{color:"primary",label:"确定",onClick:e.confirm},null,8,["onClick"])])),_:1}),y(d,{class:"q-pa-sm"},{default:r((()=>[y(p,{ref:"pickView",align:"center",modelValue:e.innerValue,"onUpdate:modelValue":t[2]||(t[2]=t=>e.innerValue=t),options:e.options,onReady:e.onDateReady,onChange:e.onDateChange},null,8,["modelValue","options","onReady","onChange"])])),_:1})])),_:1})])),_:1},8,["modelValue","position"])}],["__scopeId","data-v-0b216546"]]);export{O as _,P as a,H as b,L as u};
